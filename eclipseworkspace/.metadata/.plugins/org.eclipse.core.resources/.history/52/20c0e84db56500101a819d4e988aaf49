
<!DOCTYPE html>
<html>
	<head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        
	<link rel="stylesheet" href="css/stylz.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="css/gui.css" type="text/css" media="screen" />
    
    <title>4thFloorHvac with HTML 5</title>
    <script type="text/javascript" src="js/lib/jquery.js"></script>
    <script type="text/javascript" src="js/lib/jshashtable.js"></script>
	<script type="text/javascript" src="js/o3d-webgl/base.js"></script>
    <script type="text/javascript" src="js/o3djs/base.js"></script>
    <script type="text/javascript" src="js/hemi/core.js"></script>
    <script type="text/javascript" src="js/superb/Hud.class.js"></script>
    <script type="text/javascript" src="js/superb/floating-1.6.js"></script>
    <script type="text/javascript" src="js/lgb/core.js"></script>
	<script type="text/javascript" src="js/lgb/gui.js"></script>
		
        <script type="text/javascript">
        
			setupHandlers();
			
			
			function setupHandlers() {
				
				var jqFn = jQuery(window);
				var result = jqFn.resize(this.onResize);
				
				jQuery(window).resize(this.onLoad);
				jQuery(window).load(this.onLoad);
			}
			
			
			function onLoad(event) {
				lgb.gui.init();
				lgb.loader.init(this, 'onLoadComplete');
			}
				
			function onResize(event) {
				lgb.gui.resizeNow();
			}
			
			function onWorldSetup() {
				lgb.gui.showHud();
				document.onkeypress = returnKey;
				lgb.utils.preload('icon_exterior_envelope_over.png,icon_lighting_over.png,icon_general_over.png,icon_exterior_envelope_over.png');
			}
			
			
			
			function returnKey(evt)
			{
				var evt  = (evt) ? evt : ((event) ? event : null);
			 
				if (evt.keyCode == 13) 
				{
					var vd = new hemi.view.ViewData();
					vd.eye = [16.6,25.3,-23.6];
					
					hemi.world.camera.moveToView(vd,40);
					
				}
			}
			
			function onLoadComplete() {
	
				var result = hemi.world.camera.unsubscribe(lgb.loader.subscriberWorldReady, hemi.msg.stop);
				
				var transformList = lgb.loader.theModel.getTransforms('Mesh_033');
				var transform = transformList[0];
				var theMaterial = transform.shapes[0].elements[0].material;
				
				var drawList = theMaterial.getParam('o3d.drawList').value;
				var zdrawList = hemi.view.viewInfo.zOrderedDrawList;
				theMaterial.getParam('o3d.drawList').value = zdrawList;
				var theMaterialOpacity = hemi.fx.addOpacity(theMaterial);
				theMaterialOpacity.value = 1.0;
				
				/* Create a transform-level opacity paramater that will override the
				 * material-level opacity parameter. That way, we can make this wall
				 * fade without fading every object that uses the wall material.
				 */
				this.opacity = transform.createParam('opacity','ParamFloat');
				this.opacity.value = 1.0;
				/* On any keyDown, begin the fading. Reverse the direction each time */
				/* Fade the wall a little more on each frame, between 1 and 0.4 */
				//hemi.view.addRenderListener(this);
				
				var vp = new hemi.view.Viewpoint();		// Create a new Viewpoint
				vp.eye = [-56,61,39];					// Set viewpoint eye
				vp.target = [0,10,0];					// Set viewpoint target

				//hemi.console.addToPage();
				console.log("kuda version: " + hemi.version);
				
				hemi.world.camera.enableControl();	// Enable camera mouse control
				hemi.model.modelRoot.rotateX(4.72);
				
				
				this.subscriberCameraStopped = hemi.world.camera.subscribe(
						hemi.msg.stop,
						this,
						'onCameraMoved');
				
				hemi.world.camera.moveToView(vp,40);
			}
			
		function onCameraMoved(msg) {
				var result = hemi.world.camera.unsubscribe(this.subscriberCameraStopped, hemi.msg.stop);
				onWorldSetup();
		}
	
			
		function onRender (msg) {
			if (this.count > 0) {
				this.opacity.value += this.dir*0.02;
				this.count--;
			}
		}
		    

			
			
        </script>
        

        
    </head>
    
    <body> 
    

	<div id="o3d"></div>
	
	<div id="topTitle"></div>
	
	<div id="leftNav">
		<a id="leftNavButtonGeneral" class="leftNavButton" title="General" onClick="lgbLoader.leftNavClick(0);" href="#"></a>
		<a id="leftNavButtonHvac" class="leftNavButton" title="HVAC" href="#"></a>
		<a id="leftNavButtonEnvelope" class="leftNavButton" title="External Envelope" href="#"></a>
		<a id="leftNavButtonLighting" class="leftNavButton" title="Lighting" href="#"></a>
	</div>


    </body>
</html>