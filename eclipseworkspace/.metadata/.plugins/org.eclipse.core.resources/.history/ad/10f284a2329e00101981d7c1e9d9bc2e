o3djs.require('lgb.view.control.Button');
o3djs.require('lgb.view.control.Link');
o3djs.require('lgb.view.control.Slider');
o3djs.require('lgb.view.control.RadioButtonGroup');
o3djs.require('lgb.model.control.SelectionItem');
o3djs.require('lgb.model.control.SelectionGroup');

/**
 * @namespace A module for managing the 2D GUI
 */
var lgb = (function(lgb) {


	/**
	 * @namespace A module for managing the 2D GUI
	 */
	lgb.view = lgb.view || {};


	lgb.view.AdminSubpanel = function( dataModel ) {

		this.name = dataModel.name;
		this.title = dataModel.title;
		this.userActions = dataModel.userActions;
		this.componentControllersAry = [];
		this.init_();
	};
	
	lgb.view.AdminSubpanel.prototype = {
	
		/*
		 * for this subpanel, loop through all the available
		 * user actions and create the appropriate component
		 */
		init_ : function() {
			
			var len = this.userActions.length;
			for(var x = 0; x < len; x++) {
				var uAct =  this.userActions[x];
				var componentController;
			
				if (uAct instanceof lgb.model.control.SelectionGroup) {
					componentController = new lgb.controller.control.RadioButtonGroupController(uAct);
				}
				 
				this.componentControllersAry.push(componentController);
			}

		},
				
		
		
		getHTML : function() {
			
			var actionsHTML = '';
			
			var len = this.componentControllersAry.length;
			for(var x = 0; x < len; x++) {
				var componentController =  this.componentControllersAry[x];
				
				
				actionsHTML += componentController.getHTML() + '<br />';

			}
			
			return actionsHTML;
			
		},
		
		bindEvents : function() {

			var len = this.controlViews.length;
			for(var x = 0; x < len; x++) {
				var oneView = this.controlViews[x];
				oneView.bindEvents();
			}
		},
		
		injectHtml : function() {
			
			var actionsHtml = this.makeActionsHTML();
			
			var selector = '#{0}'.format(this.name);
			var group = 'group_{0}'.format(this.name);
			
			el = $('div.box');
			var html = '<div id="{0}" class="panel {1}">\n'.format(this.name, group) +
							'\t<h3>{0}</h3>\n'.format(this.title) +
							'\t<div>\n' + 
								actionsHtml +
							'\t</div>\n' +
						'</div>';
			
			el.append(html);
			
	        $(selector).panel({
	            accordion:group
	        });
			
			this.bindEvents();
			
		},
		
		onLinkChange : function(event) {

			var eventName =  this.id;
			
			var newEvent = jQuery.Event(eventName);
			
			newEvent.action = event.data.action;
			newEvent.value = event.target.value;

			$('body').trigger(newEvent);
		},
		
		onLinkClick : function(event) {
			var eventName =  this.name;
			
			var newEvent = jQuery.Event(eventName);
			newEvent.action = event.data.action;
			newEvent.value = event.target.value;
			
			$('body').trigger(newEvent);
		}
		

	};

	
	return lgb;
	
})(lgb || {});











