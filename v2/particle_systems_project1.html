<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>

<title>Superb Demos: Particle Systems</title>

<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />

	<link rel="stylesheet" href="css/stylz.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="css/progress.css" type="text/css" media="screen" />
    

    <script type="text/javascript" src="lib/jquery.js"></script>
    <script type="text/javascript" src="lib/jshashtable.js"></script>
    <script type="text/javascript" src="lib/JSON.js"></script>
    <script type="text/javascript" src="lib/JSONError.js"></script>
    <script type="text/javascript" src="o3djs/base.js"></script>
    <script type="text/javascript" src="hemi/core.js"></script>
	<script type="text/javascript" src="js/Progressbar.class.js"></script>
    <script type="text/javascript" src="js/ParticleSystem.class.js"></script>

  
		<script type="text/javascript">
		

			 o3djs.require('o3djs.util');
			 o3djs.require('hemi.loader');
			
			var progressbar = new Progressbar();
			var hasReached100 = false;
			var hascompleted = false;
			var particleSystem = new ParticleSystem(this, onLoadComplete);
			
		
			jQuery(window).load(function() {
				o3djs.util.makeClients(makeClientsComplete,'LargeGeometry');
				onLoadHandler();
				
			});
		
			jQuery(window).unload(function() {
				//if (hemi.core.client) {
				//	hemi.core.client.cleanup();
				//}
			});
			
			function makeClientsComplete() {
				particleSystem.init();
			}
			
			//var timer = new Timer('#page#');
			
			function onLoadHandler() {
				
				progressbar.init("Loading Geometry");
				progressbar.show();
				
			//o3djs.require('o3djs.util');
			//o3djs.require('hemi.loader');
		
				//o3djs.util.makeClients(particleSystem.init,'LargeGeometry');
				//particleSystem.loadWorld(this, onLoadComplete)
				
				//window.setTimeout('loadNow()',200);
			}
			
			function onProgress(arg) {
			   // console.log('onProgress: ' + arg.data.percent);

				progressbar.onProgress(arg.data.percent);
				//sleep(100);
				
				if (arg.data.percent == 100) {
					hasReached100 = true;
				}
				
				if (arg.data.isTotal == true && hasReached100 && (!hascompleted)) {
					//console.log('arg.data.percent: ' + arg.data.percent);
					//console.log('arg.data.percent: ' + arg.data.percent);
				 //  console.log('isTotal: true');
				   hascompleted = true;
				   
				  progressbar.init("Generating Particle Systems");
				   window.setTimeout('setupParticleSystems1()',200);
				  //onProgress(100);
				}
			}
			
			
			function onProgress2(percent) {
			    // console.log('onProgress: ' + arg);
			     
				progressbar.onProgress(percent);
				
				if (percent == 100) {
					 setViewName('vavBox');
					 window.setTimeout('progressbar.hide();',200);
					 
				}
			}
			
			
			
			function onLoadComplete() {
			  
			   // setupParticleSystems1();
				return
			}
			
			
			function loadNow() {


		  	    //this is NOT threadblocking
				
				
				//o3djs.util.makeClients(particleSystem.init,'LargeGeometry');
				
				//particleSystem.init();
				
				 
			}
			
		</script>
  
</head>

<body>


        <div id="content" >
        
        <div id="nav">
			<ul>
				<li><a href="#" onclick="particleSystemStart();">Start Particle System</a></li>
				<li><a href="#" onclick="vavSystemStart();">Start VAV System</a></li>
				<li><a href="#" onclick="boxSystemStart();">Start Box System</a></li>
				<li><a href="#" onclick="toggleBoxes();">Toggle Bounding Boxes</a></li>
				<li><a href="#" onclick="stopAllSystems();">Stop All Systems</a></li>
			</ul>
            <ul>
				<li><a href="#" onclick="setViewNumber(0);">0</a></li>
				<li><a href="#" onclick="setViewNumber(1);">1</a></li>
				<li><a href="#" onclick="setViewNumber(2);">2</a></li>
				<li><a href="#" onclick="setViewNumber(3);">3</a></li>
				<li><a href="#" onclick="setViewNumber(4);">4</a></li>
				<li><a href="#" onclick="setViewNumber(5);">5</a></li>
                <li><a href="#" onclick="setViewName('vavBox');">vavBox</a></li>
			</ul>
 		</div>
        
        
           <div id="o3d">
           		
                <div id="progressbarBackground">  
                    <div id="progressbar">
                        <div id="progressbarTitle">Loading Geometry</div>
                        <div id="indicator"><div id="progressnum">0</div></div>
                    </div>
                </div>

           </div>

        </div>



</body>
</html>
